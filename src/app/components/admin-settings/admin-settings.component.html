<div class="admin-layout">
  <!-- Top Navigation Bar -->
  <header class="top-nav">
    <div class="nav-left">
      <div class="logo">
        <svg width="32" height="32" viewBox="0 0 32 32" fill="none">
          <rect width="32" height="32" rx="6" fill="#0D6EFD"/>
          <path d="M16 8L12 12H14V20H18V12H20L16 8Z" fill="white"/>
          <rect x="10" y="22" width="12" height="2" fill="white"/>
        </svg>
        <span>Amadeus Admin</span>
      </div>
      <div class="search-box">
        <svg width="16" height="16" viewBox="0 0 16 16" fill="none">
          <circle cx="7" cy="7" r="5.5" stroke="currentColor" stroke-width="1.5"/>
          <path d="M11 11L14 14" stroke="currentColor" stroke-width="1.5" stroke-linecap="round"/>
        </svg>
        <input type="text" placeholder="Search for agencies or logs..">
      </div>
    </div>
    <div class="nav-right">
      <nav class="main-nav">
        <a routerLink="/dashboard" routerLinkActive="active">Dashboard</a>
        <a routerLink="/agencies" routerLinkActive="active">Agencies</a>
        <a routerLink="/bookings" routerLinkActive="active">Bookings</a>
        <a routerLink="/settings" routerLinkActive="active" class="active">Settings</a>
      </nav>
      <button
        class="btn btn-primary save-btn"
        (click)="saveChanges()"
        [disabled]="!hasUnsavedChanges"
      >
        Save Changes
      </button>
      <div class="user-avatar">
        <svg width="20" height="20" viewBox="0 0 20 20" fill="none">
          <circle cx="10" cy="8" r="3" stroke="currentColor" stroke-width="1.5"/>
          <path d="M4 18C4 14.6863 6.68629 12 10 12C13.3137 12 16 14.6863 16 18" stroke="currentColor" stroke-width="1.5" stroke-linecap="round"/>
        </svg>
      </div>
    </div>
  </header>

  <div class="content-wrapper">
    <!-- Settings Sidebar -->
    <aside class="settings-sidebar">
      <div class="sidebar-header">
        <h2>Settings</h2>
        <p>Manage platform pricing & rules</p>
      </div>
      <nav class="settings-nav">
        <a routerLink="/settings/global-fees" routerLinkActive="active" class="nav-item active">
          <svg width="20" height="20" viewBox="0 0 20 20" fill="none">
            <rect x="2" y="4" width="16" height="12" rx="2" stroke="currentColor" stroke-width="1.5"/>
            <circle cx="14" cy="10" r="2" fill="currentColor"/>
          </svg>
          <span>Global Fees</span>
        </a>
        <a routerLink="/settings/tax-rules" routerLinkActive="active" class="nav-item">
          <svg width="20" height="20" viewBox="0 0 20 20" fill="none">
            <path d="M4 10L8 6L12 10L16 6" stroke="currentColor" stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round"/>
            <path d="M4 14L8 10L12 14L16 10" stroke="currentColor" stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round"/>
          </svg>
          <span>Tax Rules</span>
        </a>
        <a routerLink="/settings/agency-groups" routerLinkActive="active" class="nav-item">
          <svg width="20" height="20" viewBox="0 0 20 20" fill="none">
            <circle cx="7" cy="7" r="2.5" stroke="currentColor" stroke-width="1.5"/>
            <circle cx="13" cy="7" r="2.5" stroke="currentColor" stroke-width="1.5"/>
            <circle cx="10" cy="13" r="2.5" stroke="currentColor" stroke-width="1.5"/>
          </svg>
          <span>Agency Groups</span>
        </a>
        <a routerLink="/settings/billing-logs" routerLinkActive="active" class="nav-item">
          <svg width="20" height="20" viewBox="0 0 20 20" fill="none">
            <rect x="4" y="3" width="12" height="14" rx="1" stroke="currentColor" stroke-width="1.5"/>
            <path d="M7 7H13M7 10H13M7 13H10" stroke="currentColor" stroke-width="1.5" stroke-linecap="round"/>
          </svg>
          <span>Billing Logs</span>
        </a>
        <a routerLink="/settings/audit-trail" routerLinkActive="active" class="nav-item">
          <svg width="20" height="20" viewBox="0 0 20 20" fill="none">
            <circle cx="10" cy="10" r="7" stroke="currentColor" stroke-width="1.5"/>
            <path d="M10 6V10L13 12" stroke="currentColor" stroke-width="1.5" stroke-linecap="round"/>
          </svg>
          <span>Audit Trail</span>
        </a>
      </nav>
    </aside>

    <!-- Main Content -->
    <main class="main-content">
      <div class="page-header">
        <div>
          <h1>Global Fees & Subscriptions</h1>
          <p class="subtitle">Configure markups, service fees, and models for non-IATA agencies.</p>
        </div>
      </div>

      <div class="header-actions">
        <button class="btn btn-secondary" (click)="viewHistory()">
          <svg width="18" height="18" viewBox="0 0 18 18" fill="none">
            <circle cx="9" cy="9" r="7" stroke="currentColor" stroke-width="1.5"/>
            <path d="M9 5V9L6 11" stroke="currentColor" stroke-width="1.5" stroke-linecap="round"/>
          </svg>
          View History
        </button>
      </div>

      <!-- Metrics Grid -->
      <div class="metrics-grid">
        <div class="metric-card">
          <div class="metric-label blue">Fees Collected (MTD)</div>
          <div class="metric-value">${{ feesCollected | number:'1.2-2' }}</div>
          <div class="metric-change positive">
            <svg width="12" height="12" viewBox="0 0 12 12" fill="none">
              <path d="M6 9V3M6 3L3 6M6 3L9 6" stroke="currentColor" stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round"/>
            </svg>
            +{{ feesChange }}%
          </div>
        </div>

        <div class="metric-card">
          <div class="metric-label green">Active Subscriptions</div>
          <div class="metric-value">{{ activeSubscriptions | number }}</div>
          <div class="metric-value-unit">Agencies</div>
          <div class="metric-change positive">
            <svg width="12" height="12" viewBox="0 0 12 12" fill="none">
              <path d="M6 9V3M6 3L3 6M6 3L9 6" stroke="currentColor" stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round"/>
            </svg>
            +{{ subscriptionsChange }}%
          </div>
        </div>

        <div class="metric-card">
          <div class="metric-label orange">Pending Commissions</div>
          <div class="metric-value">${{ pendingCommissions | number:'1.2-2' }}</div>
          <div class="metric-change negative">
            <svg width="12" height="12" viewBox="0 0 12 12" fill="none">
              <path d="M6 3V9M6 9L3 6M6 9L9 6" stroke="currentColor" stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round"/>
            </svg>
            {{ commissionsChange }}%
          </div>
        </div>
      </div>

      <!-- Service Fees Section -->
      <div class="section-card">
        <div class="section-header">
          <h2>Service Fees per Booking</h2>
          <button class="info-button" title="Information about service fees">
            <svg width="18" height="18" viewBox="0 0 18 18" fill="none">
              <circle cx="9" cy="9" r="7" stroke="currentColor" stroke-width="1.5"/>
              <path d="M9 8V12M9 6H9.01" stroke="currentColor" stroke-width="1.5" stroke-linecap="round"/>
            </svg>
          </button>
        </div>

        <div class="form-grid">
          <div class="form-group">
            <label class="form-label">Fixed Fee (per Passenger)</label>
            <div class="input-group">
              <span class="input-prefix">$</span>
              <input
                type="number"
                class="form-control"
                [(ngModel)]="fixedFeePerPassenger"
                (input)="onInputChange()"
                step="0.01"
              >
            </div>
            <p class="form-help">Charged for each passenger in a booking reference.</p>
          </div>

          <div class="form-group">
            <label class="form-label">Percentage Markup</label>
            <div class="input-group has-suffix">
              <input
                type="number"
                class="form-control"
                [(ngModel)]="percentageMarkup"
                (input)="onInputChange()"
                step="0.1"
              >
              <span class="input-suffix">%</span>
            </div>
            <p class="form-help">Percentage added to the total base fare + taxes from GDS.</p>
          </div>
        </div>

        <div class="info-notice">
          <svg width="16" height="16" viewBox="0 0 16 16" fill="none">
            <circle cx="8" cy="8" r="6" stroke="currentColor" stroke-width="1.5"/>
            <path d="M8 7V11M8 5H8.01" stroke="currentColor" stroke-width="1.5" stroke-linecap="round"/>
          </svg>
          <p><em>Note:</em> These values serve as the default global pricing and will be overridden by custom agency group settings.</p>
        </div>
      </div>

      <!-- Two Column Section -->
      <div class="section-grid">
        <div class="section-card">
          <div class="section-header">
            <h2>Monthly Subscription</h2>
          </div>
          <div class="section-body">
            <div class="form-group">
              <label class="form-label">Base Monthly Fee</label>
              <div class="input-group">
                <span class="input-prefix">$</span>
                <input
                  type="number"
                  class="form-control"
                  [(ngModel)]="baseMonthlyFee"
                  (input)="onInputChange()"
                  step="1"
                >
              </div>
            </div>

            <div class="form-group">
              <label class="form-label">Billing Cycle</label>
              <div class="select-wrapper">
                <select
                  class="form-control"
                  [(ngModel)]="billingCycle"
                  (change)="onInputChange()"
                >
                  <option value="every-1st">Every 1st of the month</option>
                  <option value="every-15th">Every 15th of the month</option>
                  <option value="anniversary">Anniversary date</option>
                </select>
                <svg class="select-arrow" width="12" height="12" viewBox="0 0 12 12" fill="none">
                  <path d="M3 5L6 8L9 5" stroke="currentColor" stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round"/>
                </svg>
              </div>
            </div>
          </div>
        </div>

        <div class="section-card">
          <div class="section-header">
            <h2>Recharge Commission</h2>
          </div>
          <div class="section-body">
            <div class="form-group">
              <label class="form-label">Wallet Top-up Fee</label>
              <div class="input-group has-suffix">
                <input
                  type="number"
                  class="form-control"
                  [(ngModel)]="walletTopupFee"
                  (input)="onInputChange()"
                  step="0.1"
                >
                <span class="input-suffix">%</span>
              </div>
            </div>

            <div class="form-group">
              <label class="toggle-label">
                <div
                  class="toggle-switch"
                  [class.active]="applyFeeToBankTransfers"
                  (click)="toggleBankTransfers()"
                >
                  <div class="toggle-knob"></div>
                </div>
                <span class="toggle-text">Apply fee to Bank Transfers</span>
              </label>
            </div>
          </div>
        </div>
      </div>

      <!-- Warning Card -->
      <div class="warning-card">
        <div class="warning-icon">
          <svg width="24" height="24" viewBox="0 0 24 24" fill="none">
            <path d="M12 3L22 21H2L12 3Z" stroke="currentColor" stroke-width="2" stroke-linejoin="round"/>
            <path d="M12 10V14M12 17H12.01" stroke="currentColor" stroke-width="2" stroke-linecap="round"/>
          </svg>
        </div>
        <div class="warning-content">
          <h3>Careful: High-Impact Action</h3>
          <p>Changes to these settings will affect all active bookings and future invoices globally for over 1,200 agencies. Ensure you have reviewed the financial impact before saving.</p>
        </div>
      </div>
    </main>
  </div>

  <!-- Footer -->
  <footer class="footer">
    <div class="footer-left">
      Â© 2024 Amadeus B2B Platform. System Status: <span class="status-operational">Operational</span>
    </div>
    <div class="footer-right">
      <a href="#">Privacy Policy</a>
      <a href="#">Terms of Service</a>
      <a href="#">Documentation</a>
    </div>
  </footer>
</div>
