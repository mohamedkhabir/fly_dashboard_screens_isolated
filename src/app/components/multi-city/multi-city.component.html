<div class="multi-city-container">


  <!-- Main Content -->
  <main class="main-content">
    <div class="container-full">
      <!-- Search Card - Full Width -->
      <div class="search-card">
        <!-- Trip Type Selector -->
        <div class="trip-type-tabs">
          <button
            class="trip-tab"
            [class.active]="tripType === 'one-way'"
            (click)="setTripType('one-way')">
            One Way
          </button>
          <button
            class="trip-tab"
            [class.active]="tripType === 'round-trip'"
            (click)="setTripType('round-trip')">
            Round Trip
          </button>
          <button
            class="trip-tab active"
            [class.active]="tripType === 'multi-city'"
            (click)="setTripType('multi-city')">
            Multi-city
          </button>
        </div>

        <!-- Flight Legs -->
        <div class="flight-legs">
          <div class="flight-leg" *ngFor="let leg of legs; let i = index">
            <div class="leg-inputs">
              <div class="input-field">
                <label class="input-label">FROM</label>
                <div class="input-wrapper">
                  <svg width="16" height="16" viewBox="0 0 16 16" fill="none" class="input-icon">
                    <path d="M8 2L2 5L8 8L14 5L8 2Z" fill="#6B7280"/>
                  </svg>
                  <input
                    type="text"
                    class="form-input"
                    [(ngModel)]="leg.from"
                    placeholder="London (LHR)">
                </div>
              </div>

              <div class="input-field">
                <label class="input-label">TO</label>
                <div class="input-wrapper">
                  <svg width="16" height="16" viewBox="0 0 16 16" fill="none" class="input-icon">
                    <path d="M8 2L14 5L8 8L2 5L8 2Z" fill="#6B7280"/>
                  </svg>
                  <input
                    type="text"
                    class="form-input"
                    [(ngModel)]="leg.to"
                    placeholder="New York (JFK)">
                </div>
              </div>

              <div class="input-field">
                <label class="input-label">DEPARTURE DATE</label>
                <div class="input-wrapper">
                  <svg width="16" height="16" viewBox="0 0 16 16" fill="none" class="input-icon">
                    <rect x="2" y="3" width="12" height="11" rx="1" stroke="#6B7280" stroke-width="1.5"/>
                    <path d="M2 6H14M5 2V4M11 2V4" stroke="#6B7280" stroke-width="1.5" stroke-linecap="round"/>
                  </svg>
                  <input
                    type="text"
                    class="form-input"
                    [(ngModel)]="leg.date"
                    placeholder="10/24/2024">
                </div>
              </div>

              <div class="input-field disabled-field">
                <label class="input-label">RETURN (DISABLED)</label>
                <div class="input-wrapper">
                  <svg width="16" height="16" viewBox="0 0 16 16" fill="none" class="input-icon disabled-icon">
                    <rect x="2" y="3" width="12" height="11" rx="1" stroke="#D1D5DB" stroke-width="1.5"/>
                  </svg>
                  <input
                    type="text"
                    class="form-input"
                    disabled
                    placeholder="Not applicable">
                </div>
              </div>

              <button
                class="remove-leg-btn"
                *ngIf="legs.length > 2"
                (click)="removeFlight(i)">
                <svg width="16" height="16" viewBox="0 0 16 16" fill="none">
                  <path d="M12 4L4 12M4 4L12 12" stroke="currentColor" stroke-width="2" stroke-linecap="round"/>
                </svg>
              </button>
            </div>
          </div>

          <button class="add-flight-btn" (click)="addFlight()">
            <svg width="16" height="16" viewBox="0 0 16 16" fill="none">
              <circle cx="8" cy="8" r="7" stroke="currentColor" stroke-width="1.5"/>
              <path d="M8 5V11M5 8H11" stroke="currentColor" stroke-width="1.5" stroke-linecap="round"/>
            </svg>
            Add another flight
          </button>
        </div>

        <!-- Passengers & Cabin & Search Button -->
        <div class="bottom-row">
          <div class="passengers-cabin-group">
            <div class="input-field">
              <label class="input-label">PASSENGERS</label>
              <div class="input-wrapper">
                <svg width="16" height="16" viewBox="0 0 16 16" fill="none" class="input-icon">
                  <circle cx="8" cy="5" r="2.5" stroke="#6B7280" stroke-width="1.5"/>
                  <path d="M3 13C3 10.2386 5.23858 8 8 8C10.7614 8 13 10.2386 13 13" stroke="#6B7280" stroke-width="1.5"/>
                </svg>
                <select class="form-input" [(ngModel)]="passengers.adults">
                  <option value="1">1 Adult, 0 Child</option>
                  <option value="2">2 Adults, 0 Children</option>
                  <option value="3">3 Adults, 0 Children</option>
                </select>
              </div>
            </div>

            <div class="input-field">
              <label class="input-label">CABIN CLASS</label>
              <div class="input-wrapper">
                <svg width="16" height="16" viewBox="0 0 16 16" fill="none" class="input-icon">
                  <path d="M2 5L8 2L14 5V11L8 14L2 11V5Z" stroke="#6B7280" stroke-width="1.5"/>
                </svg>
                <select class="form-input" [(ngModel)]="cabinClass">
                  <option value="Economy">Economy (Q)</option>
                  <option value="Business">Business</option>
                  <option value="First">First Class</option>
                </select>
              </div>
            </div>
          </div>

          <button class="search-btn" (click)="searchFlights()">
            <svg width="18" height="18" viewBox="0 0 18 18" fill="none">
              <circle cx="7" cy="7" r="5.5" stroke="currentColor" stroke-width="1.5"/>
              <path d="M11 11L16 16" stroke="currentColor" stroke-width="1.5" stroke-linecap="round"/>
            </svg>
            Search Flights
          </button>
        </div>
      </div>

      <!-- Two Column LayoutComponent: Filters + Content -->
      <div class="content-grid">
        <!-- Left Sidebar - Filters -->
        <aside class="filters-sidebar">
          <div class="filters-header">
            <h3>Filters</h3>
            <button class="clear-all-btn" (click)="clearFilters()">Clear All</button>
          </div>

          <!-- Stops Filter -->
          <div class="filter-section">
            <h4 class="filter-title">STOPS</h4>
            <label class="filter-checkbox">
              <input type="checkbox">
              <span class="checkbox-label">Direct</span>
              <span class="checkbox-price">from $420</span>
            </label>
            <label class="filter-checkbox checked">
              <input type="checkbox" checked>
              <span class="checkbox-label">1 Stop</span>
              <span class="checkbox-price">from $380</span>
            </label>
            <label class="filter-checkbox">
              <input type="checkbox">
              <span class="checkbox-label">2+ Stops</span>
              <span class="checkbox-price">from $350</span>
            </label>
          </div>

          <!-- Price Range Filter -->
          <div class="filter-section">
            <h4 class="filter-title">PRICE RANGE</h4>
            <div class="price-slider">
              <input type="range" min="350" max="2400" value="350" class="slider">
              <div class="price-labels">
                <span>$350</span>
                <span>$2,400+</span>
              </div>
            </div>
          </div>

          <!-- Airlines Filter -->
          <div class="filter-section">
            <h4 class="filter-title">AIRLINES</h4>
            <label class="filter-checkbox">
              <input type="checkbox">
              <span class="checkbox-label">British Airways</span>
            </label>
            <label class="filter-checkbox">
              <input type="checkbox">
              <span class="checkbox-label">Lufthansa</span>
            </label>
            <label class="filter-checkbox">
              <input type="checkbox">
              <span class="checkbox-label">Air France</span>
            </label>
          </div>
        </aside>

        <!-- Right Content Area -->
        <div class="results-area">
          <!-- Quick Stats Tabs -->
          <div class="stats-tabs">
            <div class="stat-tab">
              <div class="stat-label">CHEAPEST</div>
              <div class="stat-value">${{ stats.cheapest }}</div>
            </div>
            <div class="stat-tab">
              <div class="stat-label">FASTEST</div>
              <div class="stat-value">{{ stats.fastest }}</div>
            </div>
            <div class="stat-tab">
              <div class="stat-label">BEST VALUE</div>
              <div class="stat-value">{{ stats.bestValue }}/5</div>
            </div>
          </div>

          <!-- Info Banner -->
          <div class="info-banner">
            <svg width="18" height="18" viewBox="0 0 18 18" fill="none">
              <circle cx="9" cy="9" r="7" stroke="#0D6EFD" stroke-width="1.5"/>
              <path d="M9 5V9M9 12H9.01" stroke="#0D6EFD" stroke-width="1.5" stroke-linecap="round"/>
            </svg>
            <p>Results are shown for the entire multi-city journey. Prices include all segments and mandatory taxes.</p>
          </div>

          <!-- Flight Results -->
          <div class="flight-results">
            <div class="flight-card" *ngFor="let flight of flights">
              <!-- Card Header -->
              <div class="card-header">
                <div class="airlines-info">
                  <div class="airlines-icon">
                    <svg width="24" height="24" viewBox="0 0 24 24" fill="none">
                      <path d="M12 3L6 6L12 9L18 6L12 3Z" fill="#0D6EFD"/>
                    </svg>
                  </div>
                  <div class="airlines-text">
                    <div class="airlines-label">Multiple Airlines</div>
                    <div class="airlines-names">BA, AF â€¢ Mixed Fleet</div>
                  </div>
                </div>
                <div class="price-badge">
                  <span class="markup-label" *ngIf="flight.hasMarkup">Markup Included</span>
                  <div class="price-display">
                    <span class="price-amount">${{ flight.price.toFixed(2) }}</span>
                    <span class="price-label">Total for all flights</span>
                  </div>
                </div>
              </div>

              <!-- Flight Segments -->
              <div class="flight-segments">
                <div class="segment" *ngFor="let segment of flight.segments; let i = index">
                  <div class="segment-timeline">
                    <div class="timeline-indicator">
                      <div class="timeline-dot"></div>
                    </div>
                    <div class="segment-content">
                      <div class="segment-meta">
                        <div class="flight-info">
                          <span class="time">{{ segment.departure.time }}</span>
                          <span class="code">{{ segment.departure.code }}</span>
                        </div>
                        <div class="duration-info">
                          <span class="duration">{{ segment.duration }}</span>
                          <span class="stops">{{ segment.stops === 0 ? 'Non-stop' : segment.stops + ' stop (CDG)' }}</span>
                        </div>
                        <div class="flight-info">
                          <span class="time">{{ segment.arrival.time }}</span>
                          <span class="code">{{ segment.arrival.code }}</span>
                        </div>
                        <div class="airline-meta">
                          <span class="flight-label">Flight {{ i + 1 }}: Oct {{ 24 + (i * 7) }}</span>
                          <span class="airline-name">{{ segment.airline }}</span>
                        </div>
                      </div>
                    </div>
                  </div>
                </div>
              </div>

              <!-- Card FooterComponent -->
              <div class="card-footer">
                <div class="footer-left">
                  <svg width="16" height="16" viewBox="0 0 16 16" fill="none">
                    <circle cx="8" cy="8" r="6" fill="#E5E7EB"/>
                    <path d="M8 4V8L11 10" stroke="#6B7280" stroke-width="1.5" stroke-linecap="round"/>
                  </svg>
                  <span class="baggage-info">1x 23kg</span>
                  <svg width="16" height="16" viewBox="0 0 16 16" fill="none" style="margin-left: 16px;">
                    <path d="M8 2L12 6H4L8 2Z" fill="#E5E7EB"/>
                    <rect x="6" y="6" width="4" height="8" fill="#E5E7EB"/>
                  </svg>
                  <span class="baggage-info">Meals included</span>
                </div>
                <div class="footer-right">
                  <button class="view-details-btn" (click)="viewJourneyDetails(flight)">
                    View Journey Details
                  </button>
                  <button class="select-btn" (click)="selectBundle(flight)">
                    Select Bundle
                  </button>
                </div>
              </div>
            </div>
          </div>

          <!-- Loading Indicator -->
          <div class="loading-section">
            <div class="loading-dots">
              <span class="dot"></span>
              <span class="dot"></span>
              <span class="dot"></span>
            </div>
            <p class="loading-text">Loading 140+ more multi-city options...</p>
          </div>
        </div>
      </div>
    </div>
  </main>
</div>
